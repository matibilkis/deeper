1) Use tf.consant for the hyperparameters (this does not generate another graph when it's unnesesary)


The general rule of thumb is to only use Python side effects to debug your traces. Otherwise, TensorFlow ops like tf.Variable.assign, tf.print, and tf.summary are the best way to ensure your code will be traced and executed by the TensorFlow runtime with each call. In general using a functional style will yield the best results.

@tf.function
def f(x):
  print("Traced with", x)
  tf.print("Executed with", x)

f(1)
f(1)
f(2)



More reading:
1) https://blog.tensorflow.org/2018/07/autograph-converts-python-into-tensorflow-graphs.html
2) https://www.youtube.com/watch?v=NIEgzljyDyI
